#!/usr/bin/env php
<?php
require __DIR__.'/../config.php';

$usage = <<<'DOCOPT'
Caper - Tools for working with XDebug function traces

Usage: caper <command> [<args>...]

Commands:
  trace
  run
  php

DOCOPT;

$commands = ['trace', 'run', 'php'];

$cli = new \League\CLImate\CLImate;

$globalOptions = caper_opt_handle($usage, ['optionsFirst'=>true]);

$command = $globalOptions['<command>'];
if ($command) {
    if (!in_array($command, $commands)) {
        die("Unknown command ".escapeshellarg($command)."\n");
    }

    $_SERVER['argv'] = $argv = array_merge([$argv[0]], $globalOptions['<args>']);
    
    require CAPER_BASE_PATH."/commands/$command.php";
}
